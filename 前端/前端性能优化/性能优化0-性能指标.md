##  1. 概览

##  2. Time to First Byte 首字节时间(TTFB)

  
TTFB 是下列请求节点的时间损耗汇总：

- Redirect time 重定向时延
- Service worker 启动时延（如果适用）
- DNS 查询时延
- 建立连接和 TLS 所消耗时延
- 请求，直到响应的第一个字节到达为止的时延
- 减少连接建立和后端服务的时延将有助于降低 TTFB

![](imgs/img_1.png)

### 2.1 什么是好的 TTFB

由于 TTFB 先于核心指标，根据 75 分位的 FCP 分数作为基准，TTFB 推荐少于 0.8 秒  
![](imgs/img_2.png)

### 2.2 如何测量 TTFB

```javascript
//  直接测量，可以自定义逻辑
new PerformanceObserver((entryList) => {
  const [pageNav] = entryList.getEntriesByType("navigation");

  console.log(`TTFB: ${pageNav.responseStart}`);
}).observe({
  type: "navigation",
  buffered: true,
});

// 使用web-vitals兼容性更好
import { getTTFB } from "web-vitals";

getTTFB(console.log);
```


### 2.3 如何优化TTFB
TTFB 在很大程度上取决于托管、后端服务和网络环境  

-   优化服务器  
    适用于服务端渲染等场景，不深入讨论
-   使用CDN加速静态资源
-   使用ServiceWorker缓存HTML页面
-   尽早建立第三方连接  
    使用rel="preconnect"或者rel="dns-prefetch"来告知浏览器您的页面打算尽快建立连接 
-   避免多次重定向  
-   使用 HTTP/2 or HTTP/3


##  3. Total Blocking Time 总阻塞时间 (TBT)








